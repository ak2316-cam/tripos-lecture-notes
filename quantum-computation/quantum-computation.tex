%  \documentclass[DIV=12, a4]{scrartcl}
%\documentclass[12pt, a5]{scrartcl}

\documentclass[a4paper]{article}
\usepackage[
% fancytheorems, 
noindent, 
%spacingfix, 
%noheader
]{vanilla}


% \documentclass[a4paper]{scrreprt}
% \usepackage[
% fancytheorems, 
% noindent, 
% % %spacingfix, 
% % %noheader,
% fancyproofs
% ]{adam} 

\usepackage{tikz}
\usepackage{physics}

% \usepackage{subfig}

% \setcounter{chapter}{-1}

\title{Quantum Information \& Computation}
% \subtitle{Adam Kelly}
\author{Adam Kelly}
% \date{Michaelmas 2020}
\date{\today}

\begin{document}

\maketitle

% \begin{abstract}
	This set of notes is a work-in-progress account of the course `Quantum Information \& Computation', originally lectured by Prof Richard Jozsa in Lent 2020 at Cambridge. These notes are not a direct transcription of the lectures, but they do roughly follow what was lectured (in content and in structure).

	These notes are likely to be more succinct than other lecture notes of mine, and I have left out various aspects of what was taught. If you spot any errors in this set of notes, I can be contacted at \href{mailto:ak2316@cam.ac.uk}{ak2316@cam.ac.uk}.
% \end{abstract}

% \tableofcontents

% \clearpage

% \section{Introduction}

% Why bother with \emph{quantum} computation and information? To answer this, it helps to consider the natural of computation and information in a classical sense.

% Classical information is usually expressed in bits and bit strings. Formally these are strings of Boolean variables with values 0 or 1.

% Computation, at a fundamental level, can be thought of as updating bit strings by prescribed sequences of steps (`the program'). These are usually elementary Boolean operations/gates, for example AND, OR, NOT, SWAP and so on. A crucial property here is that each operation takes a `fixed effort' to perform, independent of the length of the string.

\tableofcontents

\section{Principles of Quantum Mechanics}


\subsection{Dirac Notation}

Let $V$ be a finite dimensional complex vector space with a (hermitian) inner product. In Dirac notation, we write vectors as 
$\ket{v}$ called \vocab{ket vectors}. 

We will often work with two dimensional space $V_2$ with a chosen orthonormal basis $\{\ket{0}, \ket{1}\}$, labelled by bit values.

By convention, kets are always written as column vectors in components. For example,
$$
\ket{v} = a \ket{0} + b\ket{1} = \begin{pmatrix}
	a \\ b
\end{pmatrix}, \quad \quad a, b\in \C.
$$

The \emph{conjugate transpose} of $\ket{v}$ is a \vocab{bra vector}, written in mirror image notation, 
$$
\bra{v} = \ket{v}^{\dagger} = a^* \bra{0} + b^* \bra{1} = \begin{pmatrix}
	a^* & b^*
\end{pmatrix},
$$
and bras are always written as row vectors in components.

More formally, bra vectors $\bra{v}$ is an element of the duel vector space $V^*$ of $V$ under the canonical isomorphism $V \cong V^*$, given by the inner product. That is, $\bra{v}$ is a linear map $\ket{w} \mapsto$ the inner product of $\ket{v}$ with $\ket{w}$.
Note that this inner product is linear in $\ket{w}$ and antilinear in $\ket{v}$ (linear in $\bra{v}$).

If $\ket{w} = c \ket{0} + d\ket{1}$, then the inner product of $\ket{v}$ with $\ket{w}$ is written by juxtaposing the bra and ket, 
$$
\ip{v}{w} = \ket{v}^{\dagger} \ket{w} = \begin{pmatrix}
	a^* & b^*
\end{pmatrix} \begin{pmatrix}
	c \\ d
\end{pmatrix} = a^* c + b^* d.
$$

For example, the orthonormality of basis vectors can be written as $\ip{i}{j} = \delta_{ij}$.

\subsection{Tensor Products of Vectors}

For some vector space $V$ of dimension $m$ on a basis $\ket{e_1}, \dots, \ket{e_m}$, and another vector space $V$ of dimension $n$ on a basis $\ket{f_1}, \dots, \ket{f_n}$, the \vocab{tensor product space} $V \otimes W$ has dimension $mn$ with orthonormal basis $\{ \ket{e_i} \otimes \ket{f_j} \}$, $i \in \{1, \dots, m\}$, $j \in \{1, \dots, n\}$, where $\otimes$ is bilinear.
Then a general ket vector in $V \otimes W$ is
$$
\ket{v} = \sum c_{ij} \ket{e_i} \otimes \ket{f_j}.
$$

There is a natural \emph{bilinear} map $f: V \times W \rightarrow V \otimes W$. If $\ket{\alpha} = \sum a_i \ket{e_i}$ and $\ket{\beta} = \sum b_j \ket{f_j}$, then
\begin{align*}
	(\ket{\alpha}, \ket{\beta}) &\mapsto f \mapsto \ket{a} \otimes \ket{b}\\
	&= \left(\sum a_i \ket{e_i}\right) \otimes \left(\sum b_j \ket{f_j}\right) \\
	&= \sum_{ij} a_i b_j \ket{e_i} \otimes \ket{f_j}.
\end{align*}

Note that $\otimes$ is not commutative. For example, if $V = W$ then $\ket{\alpha} otimes \ket{\beta} \neq \ket{\beta} \otimes \ket{\alpha}$ in general. We will often omit the symbol $\otimes$ and will write $\ket{\alpha} \otimes \ket{\beta}$ as $\ket{\alpha} \ket{\beta}$.

The mapping $f$ is \emph{not surjective}. 
With this in mind, we introduce the notions of \emph{product} and \emph{entangled} vectors.

\begin{definition}[Product and Entangled]
	Any $\ket{\xi} \in V \otimes W$ of the form $\ket{\xi} = \ket{\alpha} \otimes \ket{\beta}$ is called a \vocab{product vector}.
	Any $\ket{\xi}$ that is \emph{not} a product vector is called \vocab{entangled}.
\end{definition}

We will mostly be concerned with tensor products of the $2$ dimensional $V_2$ with itself (possible many times over).
For the $k$-fold tensor power, we write $\bigotimes^k V_2 = V_2 \otimes \cdots \otimes V_2$. This has dimension $2^k$ and orthonormal basis
$$
\ket{i_1} \otimes \cdots \otimes \ket{i_k}, \quad \quad i_1, \dots, i_k \in \{0, 1\}.
$$
These basis vectors are labelled by $2^k$ $k$-bitstrings. We will often write $\ket{i_1} \otimes \cdots \ket{i_k}$ as $\ket{i_1} \cdots \ket{i_k}$ or $\ket{i_1 \dots i_k}$.

\begin{example}
	The vector $\ket{v} = \ket{00} + \ket{11}$ in $V_2 \otimes V_2$ is \emph{entangled}. To see this, suppose we could write $\ket{v}$ as a product:
	\begin{align*}
	\ket{v} &= (a\ket{0} + b\ket{1})\otimes(c\ket{0} + d\ket{1}) \\
		&= ac \ket{00} + ad \ket{01} + bc \ket{10} + bd \ket{11}.
\end{align*}
Comparing with the coefficients of $\ket{v}$, we get $ad = 1$, $ad = 0$, $bc = 0$ and $ad = 1$. But then $abcd = (ac)(bd) = 1$ and $abcd = (ad)(bc) = 0$, which is a contradiction. Thus $\ket{v}$ must be entangled.
\end{example}
We can show that
$$
\ket{v} = a_{00} \ket{00} +a_{01} \ket{01} +a_{10} \ket{10} +a_{11} \ket{11} 
$$
is entangled if and only if $\det(a_{ij}) \neq 0$. For general dimensions,
$$
\sum_{i = 1, j = 1}^{m, n} A_{ij} \ket{i} \ket{j}
$$
is a product vector if and only if the matrix $[A_{ij}]$ has rank 1.

The inner product on $V \otimes W$ is induced the inner products on $V$ and $W$, `applied slotwise'. For product states $\ket{\alpha_1} \ket{\beta_2}$ and $\ket{\alpha_2} \ket{\beta_2}$, the inner product is
$$
(\bra{b_1} \bra{\alpha_1})(\ket{\alpha_2} \ket{\beta_2}) = \ip{\alpha_1}{\alpha_2} \ip{\beta_1}{\beta_2},
$$
and we extend by linearity to all $\ket{\xi} \in V \otimes W$.

\begin{remark}[Notation]
	For the bra vector of $\ket{\alpha} \ket{\beta}$, we often reverse the order and write is as $\bra{\beta} \bra{\alpha}$. It is always important to keep track of component slots. We sometimes include explicit labels (for example, $\ket{\alpha}_A \ket{\beta}_B$ has bra vector ${}_A\bra{\alpha} {}_B \ket{\beta} = {}_B\ket{\beta} {}_A \ket{\alpha}$). 
\end{remark}

\subsection{Quantum Principles}

We will now state some axioms that describe quantum mechanics.

\subsubsection{QM1 -- Physical States}

\begin{axiom*}[QM1]
	The state of any (isolated) physical system $S$ are represented by unit vectors in a complex vector space $V$ with a given inner product.
\end{axiom*}

The simplest nontrivial case is $V = V_2$, the two dimensional complex vector space. We choose a pair of orthonormal vectors $\ket{0}$ and $\ket{1}$. Then a general state is
$$
\ket{\psi} = \alpha \ket{0} + \beta \ket{1}, \quad \quad \alpha, \beta \in \C, \quad |\alpha|^2 + |\beta|^2 = 1.
$$
We say $\ket{\psi}$ is a \vocab{superposition} of $\ket{0}$ and $\ket{1}$ with \vocab{amplitudes} $\alpha$ and $\beta$ respectively.

\begin{definition}[Qubit]
	A \vocab{qubit} is any quantum system with a two dimensional state space and a chosen orthonormal basis labelled $\ket{0}$, $\ket{1}$ called the \vocab{computational} basis, \vocab{standard} basis or $Z$-basis.
\end{definition}

\begin{definition}[Conjugate Basis for a Qubit]
	Given an orthonormal pair $\ket{0}$ and $\ket{1}$, we get the orthonormal pair
	\begin{align*}
		\ket{+} &= \frac{1}{\sqrt{2}} \left(\ket{0} + \ket{1}\right),
		\ket{-} &= \frac{1}{\sqrt{2}} \left(\ket{0} - \ket{1}\right).
	\end{align*}
	We call this the \vocab{conjugate} basis or $X$-basis.
\end{definition}

\subsubsection{QM2 -- Composite Systems}

\begin{axiom*}[QM2]
	If system $S_1$ has state space $V_1$ and system $S_2$ has state space $V_2$ then the joint system $S_1 S_2$, obtained by taking $S_1$ and $S_2$ together, has state space $V_1 \otimes V_2$.
\end{axiom*}

Comparing this axiom with the classical analog,
the corresponding statement has a Cartesian product rather than a tensor product. So giving a state for a classical $S_1S_2$ is just giving a state for $S_1$ and giving a state for $S_2$. Thus the dimension of the system grows linearly with the number of systems, whereas in the quantum sense (with this axiom), the composite system grows \emph{exponentially} with the number of systems.

\begin{example}[$n$-qubit system]
	An $n$-qubit system has as state space $V_2^{\otimes n}$, with dimension $2^n$. It has the computational basis $\ket{i_1 \dots i_n}$, labelled by all $2^n$ $n$-bit string.

	An $n$ qubit state $\ket{\psi}$ is a \vocab{product state} if is the tensor product of $n$ single qubit states $\ket{\psi} = \ket{v_1} \ket{v_2} \cdots \ket{v_n}$, otherwise it is \vocab{entangled}.
\end{example}

Before we state the next axiom, we need to introduce how to work with linear maps in Dirac notation.

Consider linear maps on $V_2$ (higher-dimensions are similar) with $\ket{v} = a \ket{0} + b \ket{1}$ and $\ket{w} = c\ket{0} + d\ket{1}$. Then the `ket-bra' product is
$$
M = \op{v}{w} = \begin{pmatrix}
	a \\ b
\end{pmatrix}\begin{pmatrix}
	c^* &  d^*
\end{pmatrix} = \begin{pmatrix}
ac^* & ad^* \\
bc^* &  bd^*
\end{pmatrix},
$$
which is a linear map on $V_2$. For any $\ket{x} = (x_0, x_1)^T$, we have
$$
M \ket{x} = (\op{v}{w}) \ket{x} = \ket{v} \ip{w}{x}.
$$
These are all rank 1 mappings, and thus is not the most general linear map.

For a general linear map say
$$
A = \begin{pmatrix}
	a_{00} & a_{01} \\
	a_{10} & a_{11}
\end{pmatrix},
$$
we note that for basis states,
\begin{align*}
	\op{0}{0} = \begin{pmatrix}
		1 & 0 \\
		0 & 0 
	\end{pmatrix}, \quad \op{0}{1} = \begin{pmatrix}
		0 & 1 \\
		0 & 0 
	\end{pmatrix}, \quad \op{1}{0} = \begin{pmatrix}
		0 & 0 \\
		1 & 0 
	\end{pmatrix}, \quad \op{1}{1} = \begin{pmatrix}
		0 & 0 \\
		0 & 1 
	\end{pmatrix},
\end{align*}
and we can see that these are a basis for $2\times 2$ matrices, and we can express
$$
A = a_{00} \op{0}{0} +  a_{01} \op{0}{1} +  a_{10} \op{1}{0} +  a_{11} \op{1}{1} = \sum a_{ij} \op{i}{j}.
$$

Another useful property comes from the cycic property of the trace:
$$
\ip{v}{w} = \tr(\op{v}{w}).
$$

An important operation comes from the above when $\ket{v} = \ket{w}$ (in any dimension), and where $\ket{v}$ is normalized so $\ip{v}{v} = 1$. Then $\Pi_v = \op{v}{u}$ is the operation of projection onto the 1-dimensional subspace spanned by $\ket{v}$. For example, we have
\begin{align*}
\Pi_v \Pi_v = \ket{v}\ip{v}{v} = \op{v}{v} = \Pi_v.
\end{align*}
More generally if $E$ is any $d$-dimensional linear subspace of $n$-dimensional space $V$ and $\{\ket{e_1}, \dots, \ket{e_d}\}$ is any orthonormal basis of $E$, then $\Pi_E = \op{e_1}{e_1} + \cdots + \op{e_d}{e_d}$ is the operation of projection on to $E$. $\Pi_E$ is independent of the orthonormal basis chosen.

We also want to have tensor products of maps. If 
$$
A = \begin{pmatrix}
	a & b \\ c & d
\end{pmatrix}, \quad \text{and} \quad B= \begin{pmatrix}
	p & q \\ v& s
\end{pmatrix}
$$
are linear maps on $V_2$ then $A \otimes B : V_2 \otimes V_2 \rightarrow V_2 \otimes V_2$ defined by the basis action
$$
\ket{i} \ket{j} \longmapsto (A \ket{i})(B \ket{j}),
$$
with linear extension.

For example, for any product sate $\ket{v}\ket{w}$, we have $(A \otimes B) \ket{v} \ket{w} = (A \ket{v})(B \ket{w})$.

In components for the $2\times 2$ case we have
$$
\sbox0{$\begin{matrix}ap&aq\\av&as\end{matrix}$}
A \otimes B = \begin{pmatrix}
	aB & bB \\
	cB & dB
\end{pmatrix} = \left(
	\begin{array}{c|c}
	\usebox{0}&\makebox[\wd0]{\large $bB$}\\
	\hline
	  \vphantom{\usebox{0}}\makebox[\wd0]{\large $cB$}&\makebox[\wd0]{\large $dB$}
	\end{array}
	\right),
$$
with other cases done similarily.

Some important special cases are $I \otimes A$ and $A \otimes I$, the action of $A$ on the second (or first) component space of $V_2 \otimes V_2$. We often refer to these as \vocab{local operations} on subsystems of composite systems.

\subsubsection{QM3 -- Physical Evolution of Quantum Systems}

\begin{axiom*}[QM3]
	Any physical (finite time) evolution of a quantum system is represented by a \vocab{unitary} linear operation on the vector space of states.
\end{axiom*}

The analog to this from the Quantum Mechanics course would be Schr\"odinger's equation and specifically is the finite dimensional version of Schr\"odinger's equation, where instead of a hamiltonian we have a hermitian operation on the state space, where evolution is
$$
\frac{\mathrm{d}\ket{\psi}}{\mathrm{d}t} = H \ket{\psi}
$$
If $H$ is time independent, then $\ket{\psi} = e^{-\frac{i}{\hbar}Ht}\ket{\psi_0}$, which is the matrix exponential. This also implies that $A$ hermitian gives $e^{iA}$ unitary.

Recall that a matrix $U$ is unitary if $U^{-1} = U^{\dagger}$, that is, if and only if $U$ maps any orthonormal basis to an orthonormal set of vectors, which occurs if and only if the columns or rows of the matrix of $U$ form an orthonormal set of vectors.

The last piece of notation we will introduce is the partial inner products. For vectors in $V \otimes W$, then any ket $\ket{v} \in V$ defines a linear map $V \otimes W \rightarrow W$ called the `partial inner product with $\ket{v}$', defined on basis vectors $\ket{e_i} \ket{f_j} \in V \otimes W$ where $\ket{e_i}\ket{f_j} \mapsto \ip{v}{e_i} \ket{f_j}$, and similarity for $\ket{w} \in W$ giving a map $V \otimes W \rightarrow V$). If $V = W$ (as often occurs), it is important to specify which space of $V \otimes V$ is being used.


\begin{example}
	For $V = V_2$, and $\ket{\xi} = a \ket{00} + b\ket{01} + c \ket{10} + d\ket{11} \in V \otimes V$, we can form the partial inner product with $\ket{0}$ on \emph{either} space. So first label the spaces as $V_A \otimes V_B$ where $V_A = V_B = V$. Then the orthonormality relations $\ip{i}{j} = \delta_{ij}$ gives
	\begin{align*}
		{}_A\ip{0}{\xi}_{AB} &= a {}_A\ip{0}{0}_A \ket{0}_B + b {}_A\ip{0}{0}_A \ket{1}_B + c{}_A\ip{0}{1}_A \ket{0}_B + d{}_A\ip{0}{1}_A \ket{1}_B \\
		&= a\ket{0}_B + b\ket{1}_B. 
	\end{align*}
	That is, we pick out the terms of $\ket{\xi}_{AB}$ with a zero in the $A$ slot.
\end{example}

\subsubsection{QM4 -- Quantum Measurement \& Born Rule}

This axiom describes how classical information is extracted from quantum states. Fundamentally there is a physical limitation on this process and it is rather different than the extraction of classical information.

Typically in a classical setting, we assume that measurements can occur without changing the physical system being studied. For example, if you measured the height of a tree, you wouldn't expect the act of measuring to make the tree any smaller. This is different in a quantum setting, as we shall see.

We will work with a given \emph{single} instance of a quantum state $\ket{\psi}$ of a physical system, with a state space $V$ of dimension $n$.

We first have the \vocab{basic Born rule}, a complete projective measurement (or von Neumann measurement). Let $B = \{\ket{e_1}, \dots, \ket{e_n}\}$ be any orthonormal basis of $V$. We can make a measurement on $\ket{\psi}$ relative to the basis $B$.

Letting $\ket{\psi} = \sum a_i \ket{e_i}$, the possible measurement outcomes are $j = 1, 2, \dots, n$, and the probability of getting an outcome $j$ is $\operatorname{prob}(j) = |\ip{e_j}{\psi}|^2 = |a_j|^2$. If outcome $j$ is seen, then the state is no longer $\ket{\psi}$, but it has been \vocab{collapsed} to $\ket{\psi_j} = \ket{e_j}$.

Clearly this transformation is not unitary, and thus we have a completely different physical process to evolution as described before.
Notably, repeated measurement gives only the same result, with certainty. We would not get further samples of the $|a_j|^2$ distribution.

To rephrase, the probability is the squared length of $\ket{\psi}$ onto the basis direction $\ket{e_j}$, and the post measurement state is that projection, re-normalized to unit length.

The `complete' above refers to the \emph{one}-dimensionality of the orthonormal subspaces, defined by basis states. We can similarity describe incomplete projective measurements.

Let $\{E_1, E_2, \dots, E_d \}$ by a decomposition of $V$ into $d$ mutually orthogonal subspaces, so $V = E_1 \oplus \cdots \oplus E_d$, and let $\Pi_i$ be the projection onto $E_i$. Then the \vocab{incomplete} projective measurement of $\ket{\psi}$ with respect to the orthogonal decomposition is the following quantum operation. The possible outcomes are $j = 1, \dots, d$, and $\operatorname{prob}(j) = \text{squared length of projection of $\ket{\psi}$ into $E_j$} = \mel{\psi}{\Pi_j^{\dagger} \Pi_j}{\psi} = \mel{\psi}{\Pi_j}{\psi}$.
(Recall that $\Pi \Pi = \Pi$ and $\Pi^{\dagger} = \Pi$). This is also $\operatorname{tr}(\Pi_j \op{\psi}{\psi})$.

The post measurement state is the projected `collapsed' vector, re-normalised. So $\ket{\psi_j} = \frac{\Pi_j \ket{\psi}}{\operatorname{prob}(j)}$.

\begin{example}[Parity Measurement on 2-Qubits]
	The parity of a 2-bit string $b_1b_2$ is the modulo 2 sum $b_1 \oplus b_2$. The parity measurement on two qubits is teh incomplete measurement with orthogonal decomposition
	$$
	E_0 = \operatorname{span}\{\ket{00}, \ket{11}\}, \quad \quad E_1 = \operatorname{span}\{\ket{01}, \ket{10}\}.
	$$
	For $\ket{\psi} = a \ket{00} + b\ket{01} + c\ket{10} + d\ket{11}$, we see $0$ with probability $|a|^2 + |d|^2$, and the post measurement state would be $\frac{a \ket{00} + d \ket{11}}{\sqrt{|a|^2 + |d|^2}}$.
\end{example}

In some texts (especially pre-2000s) they will typically introduce measurement in the context of `quantum observables'.

\begin{definition}[Observable]
	A quantum observable $\theta$ is a hermitian operator on $V$ so that $\theta$ has real eigenvalues $\lambda_j$ for $j = 1, \dots, d$, and orthogonal eigenspaces $\Lambda_j$, with $\operatorname{dim}(\Lambda_j)$ being the multiplicity of $\lambda_j$, and $V = \Lambda_1 \oplus \cdots \oplus \Lambda_d$. 
\end{definition}

The measurement of a quantum observable $\theta$ is then just the incomplete measurement relative to this orthogonal decomposition.
However, these observables' eigenvalues relate to physical properties, and we thus normally label the outcomes by their eigenvalues $\lambda_j$, not just $j$ as before. We also have things like $\expval{\theta} = \sum \lambda_j \operatorname{prob}(j)$, which obviously depend on the eigenvalues. 

But for the purposes of providing information about $\ket{\psi}$ and its post measurement state, the choice of labelling is immaterial and thus we won't be that interested in observables.

A special case of incomplete measurement relates to measuring a component part of a quantum system, the \vocab{extended Born rule}.

Suppose $\ket{\psi}$ is a state of a composite system $S_1 S_2$ with state space $V \otimes W$. Let $B_V = \{\ket{e_1}, \dots, \ket{e_n}\}$ be an orthonormal basis of $V$. We can uniquely express $\ket{\psi}$ uniquely as $\ket{\psi}_{VW} = \sum_i \ket{e_i}_V \ket{\xi_i}_W$, where $\ket{\psi_i}$ are generally not normalized, and not orthogonal. In fact, $\ket{\xi_i}_W = {}_V\ip{e_i}{\psi}_{VW}$.
Thus $\ket{\psi}$ normalised implies $\sum_{i = 1}^n \ip{\xi_i}{\xi_i} = 1 = \ip{\psi}{\psi}$.

Now, if we say perform a measurement of $\ket{\psi}$ relative to a basis $B_V$ of $V$ (a `complete measurement on $V$ but not $V \otimes W$') with outcomes $i = 1, \dots, n$, and corresponding orthogonal subspaces (of $V \otimes W$), $E_i = \operatorname{span} \{\ket{e_i} \otimes \ket{\xi} \mid \ket{\xi} \in W\}$, which we write as $\ket{e_i} \otimes W$. The corresponding projectors are $\Pi_i = \op{e_i}{e_i}\otimes I_W $, and $\operatorname{prob}(i) = \ip{\xi_i}{\xi_i}$. The post measurement state for $i$ is $\ket{\psi_i} = \frac{\ket{e_i}_V \ket{\xi_i}_w}{\sqrt{\ip{\xi_i}{\xi_i}}}$.

\begin{remark}
	According to QM4 (all of the measurement rules), two different states with guaranteed (probability 1) different outcomes for some measurement, must lie in orthogonal subspaces (they must be orthogonal themselves). So non-orthogonal state, although physically different, can never be reliably distinguished (`as information') by any quantum process.

	Also, if $\ket{\psi}$ has dimension $n$, any measurement on it has at most $n$ outcomes. However, we can get more outcomes by adjoining an ancilla $\ket{A}$ of dimension $m$ (independent of $\ket{\psi}$) and measure $\ket{\psi}\ket{A}$ to get up to $mn$ outcomes. 
\end{remark}

\subsection{Quantum Gates}

We will finish looking at the principles of quantum mechanics that we will be using by looking at some basic unitary operations for qubits, which are known as \vocab{quantum gates}.

\subsubsection{Single Qubit Gates}

We will begin by listing some gates that act on a single qubit.

\begin{itemize}
	\item The Hadamard gate, 
	$$H = \frac{1}{\sqrt{2}}\begin{pmatrix}
		1 & 1 \\
		1 & -1
	\end{pmatrix}.$$
	We have $H\ket{0} = \ket{+} = \frac{1}{\sqrt{2}}(\ket{0} + \ket{1})$, and $H\ket{1} = \ket{-}$.
	
	\item The Pauli operations/gates,
	$$
	I = \begin{pmatrix}
		1 & 0 \\ 0 & 1
	\end{pmatrix}, \quad \sigma_x = \begin{pmatrix}
		0 & 1 \\ 1 & 0
	\end{pmatrix}, \quad \sigma_y = \begin{pmatrix}
		0 & -i \\ i & 0
	\end{pmatrix}, \quad \sigma_z = \begin{pmatrix}
		1 & 0 \\0 & -1
	\end{pmatrix}.
	$$
	These matrices are all unitary and hermitian. These matrices have multiplicative (group) properties, for example $\sigma_x^2 = \sigma_y^2 = \sigma_z^2 = I$, so the eigenvalues are $\pm 1$, and they all anti-commute, $\sigma_x \sigma_y = - \sigma_y \sigma_z$, and there's cyclic shifts, for example $\sigma_y \sigma_z = \sigma_x$.

	We will often use the `real versions' as quantum gates,
	$$
	X = \sigma_x, \quad Z = \sigma_z, \quad Y = i \sigma_y = \begin{pmatrix}
		0 & 1 \\
		-1 & 0
	\end{pmatrix}.
	$$

	Note that $X\ket{0} = \ket{1}$, so this gate is often known as the `quantum NOT gate'. The $X$ eigenbasis is $\ket{+}, \ket{-}$. The $Z$ gate satisfies $Z \ket{0} = \ket{0}$, and $Z\ket{1} = - \ket{1}$. The $Z$ eigenbasis is $\ket{0}$, and $\ket{1}$. Note the relation to the $X$ and $Z$ basis mentioned before.

	\item The phase gates
	$$
	P(\theta) = \begin{pmatrix}
		1 & 0 \\
		0 & e^{i \theta}
	\end{pmatrix}.
	$$
	Note that $Z = P(\pi)$.
\end{itemize}

\subsubsection{Two Qubit Gates}

There are also gates that act on multiple qubits.
The most common examples of two qubit gates are the `controlled' gates.

\begin{itemize}
	\item The $CX$, or controlled-$X$ gate. This is a two qubit gate where the action of the $X$ gate on the second qubit is controlled by the value of the first qubit.
	
	To define it on a basis, $CX \ket{j}\ket{k} = \ket{j} \ket{j \oplus k} = \ket{j} X^{j} \ket{k}$, where $\oplus$ is addition modulo 2. So $CX \ket{0} \ket{\alpha} = \ket{0} \ket{\alpha} = CX\ket{1}\ket{\alpha} = \ket{1} X \ket{\alpha}$.

	The matrix for the $CX$ gate is
	$$
	CX = \begin{pmatrix}
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 \\
		0 & 0 & 0 & 1 \\
		0 & 0 & 1 & 0
	\end{pmatrix}.
	$$
	We typically call the first qubit the \vocab{control} qubit and the second qubit the \vocab{target} qubit. The two qubits have asymmetrical roles, so sometimes we write $CX_{ab}$ to mean $a$ is the control qubit and $b$ is the target qubit to make this explicit.

	\item The $CZ$, or controlled-$Z$ gate. This is $CZ_{12}\ket{i}\ket{j} = \ket{j} z^j\ket{k} = (-1)^{jk}\ket{j}\ket{k}$. 
	
	Somewhat unusually, this controlled gate is symmetric, where $CZ_{12} = CZ_{21}$. The matrix for this gate is
	$$
		CZ = \begin{pmatrix}
			1 & 0 & 0 & 0 \\
			0 & 1 & 0 & 0 \\
			0 & 0 & 1 & 0 \\
			0 & 0 & 0 & -1 
		\end{pmatrix}.
	$$
\end{itemize}

\section{Quantum States as Information Carriers}

Recall that information corresponds to distinguishable states of a physical system. Classically, \emph{any} two different states are distinguishable (in principle). Quantumly, states are distinguishable reliably if and only if they are \emph{orthogonal}.
A qubit is the simplest quantum system that can reliably encode a classical bit, even though it has infinitely many different states.

So if given a quantum state $\ket{\psi}$, it is impossible to identify its identity with certainty.
For example, if given $\ket{0}, \ket{+}$ as `yes' and `no', we would not be able to reliably distinguish between the answers.

We call `what we get' quantum information.

Given some quantum information $\ket{\psi}$, we have three basic operations that we can perform on it.
\begin{enumerate}
	\item \emph{Ancilla}. We can take a fixed known quantum state $\ket{A}$ and adjoin it to get $\ket{\tilde{\psi}} = \ket{\psi} \ket{A}$. $\ket{A}$ is called an \vocab{ancilla}.
	\item \emph{Unitary}. We can apply a unitary $U$ of our choice, with $\ket{\psi}$ becoming $U\ket{\psi}$.
	\item \emph{Measure}. We can perform a measurement on (part of) $\ket{\psi}$. We can record this result, and then use the post-measurement state for further quantum information processing. This further processing could be chosen adaptively depending on the measurement outcome.
	
	The output here is generally a probabilistic mixture over post-measurement states, corresponding to the Born rule.
\end{enumerate}
Most generally, we can do any sequence of the three actions above.

\subsection{The No-Cloning Theorem}

Informally, the no-cloning theorem says that `quantum information cannot be copied or cloned'. This is unlike the classical situation where any information can be copied.

Given some quantum information $\ket{\psi}_A$, any copy/cloning process is a quantum evolution process of $A$, $B$ and $M$, with
$$
\ket{\psi}_A \ket{0}_B \ket{M_0}_M \longrightarrow  \ket{\psi}_A \ket{\psi}_B \ket{M_{\psi}}_M.
$$
Here, $B$ is a quantum system of the same dimension as $A$, usually in a `blank', fixed state (independent of $\psi$), and $M$ is any other system needed to perform the copying, stating in some `ready'-state $\ket{M_0}$ (also independent of $\psi$). The final state of $M$ may depend on $\ket{\psi}$ though.

\begin{theorem}[No-Cloning Theorem, Unitary Version]
	Let $\mathcal{S}$ be any known set of quantum state of $A$ that contains at least one pair $\ket{\xi} \neq \ket{\eta}$ of non-orthogonal states.
	Then no unitary process exists that achieves cloning of all states in $S$.
\end{theorem}
\begin{proof}
	Let $\ket{\xi}$, $\ket{\eta}$ be two different non-orthogonal states. Then the cloning process must do:
	\begin{align*}
		\ket{\xi}_A \ket{0}_B \ket{M_0}_M &\longrightarrow \ket{\xi}_A \ket{\xi}_B \ket{M_\xi}_M, \\
\ket{\eta}_A \ket{0}_B \ket{M_0}_M&\longrightarrow \ket{\eta}_A \ket{\eta}_B \ket{M_{\eta}}_M.
	\end{align*}
	We note that unitary operations preserve inner products, so the inner products of the LHS must equal the inner products of the RHS. So
	\begin{align*}
		\ip{\xi}{\eta} \ip{0}{0} {M_0}{M_0} = \ip{\xi}{\eta} \ip{\xi}{\eta} \ip{M_\xi}{M_\eta}.
	\end{align*}
	Taking absolute values, we then have to have
	$$
	|\ip{\xi}{\eta}| = |\ip{\xi}{\eta}|^2 |\ip{M_\xi}{M_\eta}|.
	$$
	Since $\ket{\xi} \neq \ket{\eta}$, and they are not orthogonal, we have $0 < |\ip{\xi}{\eta}| < 1$, and in particular it is non-zero. But then $1 = |\ip{\xi}{\eta}| \cdot |\ip{M_\xi}{M_\eta}|$, which is a contradiction since $|\ip{\xi}{\eta}| < 1$.
\end{proof}

\begin{remark}
	Note that if $\ket{\xi} = \ket{\eta}$, then we \emph{can} clone (trivially). Also if $\ket{\xi}$ and $\ket{\eta}$ are orthogonal, then we also can clone. We can do this by rotating to get $\ket{0}$ perpendicular to $\ket{1}$, and then applying the $CX$ gate.
	Also this, this theorem is true when we include non-unitary processes (such as adding ancillas, or performing measurement).
\end{remark}

	The no cloning theorem was proved in 1982 by W. Wootters, W. Zurek, and D. Dieks independently in the same year. However, it had also been proved in 1970 by J. Park, but that went somewhat unnoticed.

	This theorem was a response to N. Herbert (1980), who had a proposal for superliminal signalling in quantum mechanics. His error was to assume cloning of quantum states.

	His method centered around having two participants Alice and Bob, distantly separated in space, who share an entangled state
	$$
	\ket{\phi^+} = \frac{1}{\sqrt{2}}(\ket{0}_A \ket{0}_B + \ket{1}_A \ket{1}_B).
	$$
	It is easy to check that this is the same as
	$$
	\ket{\phi^+} = \frac{1}{\sqrt{2}}(\ket{+}_A \ket{+}_B + \ket{-}_A \ket{-}_B).
	$$
	Alice wants to communicate a yes/no decision to Bob at noon, instantaneously. Alice decides that to communicate a `yes', she will measure in the $\{\ket{0}, \ket{1}\}$ basis, and to communicate a `no', she will measure in the $\{\ket{+}, \ket{-}\}$ basis. 

The Born rule implies that Bob's qubit is instantaneously collapsed. So for the `yes' action, with $50/50$ probability he will be holding $\ket{0}$ or $\ket{1}$. For the no action, with $50/50$ probability he will be holding $\ket{+}$ or $\ket{-}$.

But these yes/no preparations of $B's$ qubits are \emph{indistinguishable} by any local action for Bob. 
For any measurement, the output probabilities are the same in both cases.

Indeed, if $\Pi_i$ is the projection operator for outcome $i$ in a measurement for Bob, then in the yes case, $p_{\text{yes}}(i) = \frac{1}{2}\ev{\Pi_i}{0}  +\frac{1}{2}\ev{\Pi_i}{1} = \tr\left(\Pi_i \left(\frac{\op{0}{0} + \op{1}{1}}{2}\right)\right)$. In the no case, $p_{\text{no}}(i) = \tr\left(\Pi_i \left(\frac{\op{+}{+} + \op{-}{-}}{2}\right)\right)$, but $\op{0}{0} + \op{1}{1} = \op{+}{+} + \op{-}{-} = I$, and the probabilities are equal. Thus $B$ cannot detect $A's$ attempted signalling.

Now if $B$ could \emph{clone} quantum states, then just after noon, Bob could clone his qubit many times (say $10^6$). Now in the `yes' case, all will be zero or all will be one. Similarly in the `no' case, he measures all copies in the $\{\ket{0}, \ket{1}\}$ basis and he will see a uniformly random bit string. Of course this is not possible, by the above result.

\subsection{Distinguishing Non-Orthogonal States}

We know that we can't perfectly distinguish non-orthogonal states. But how well can we do it?

\begin{itemize}
	\item \emph{Given}. An unknown quantum state $\ket{\psi}$ of dimension $d$.
	\item \emph{Promise}. $\ket{\psi}$ is either $\ket{\alpha_0}$ or $\ket{\alpha_1}$, which are distinct known states.
	\item \emph{Problem}. Determine which $i$ is such that $\ket{\psi} = \ket{\alpha_i}$.
\end{itemize}

We will apply the \emph{state estimation} process.

Given $\ket{\psi}$, we can adjoin an ancilla $\ket{A}$ to give $\ket{\psi}\ket{A}$. Then we can perform a unitary on the full system, and we can perform a measurement with outcomes $0$ and $1$ for our answer.

\begin{remark}
	It can be shown (as with the no-cloning theorem) that this process is completely general.
\end{remark}

We can simplify this process. Adjoining $\ket{A}$ just changes discrimination of $\ket{\alpha_0}$ vs $\ket{\alpha_1}$ to that of $\ket{\alpha_0}\ket{A}$ vs $\ket{\alpha_1}\ket{A}$, with the same inner product. So this is just working in a larger dimension (and we will see later that the dimension will not matter).

If we call the process $M_1$ `doing $U$ followed my measurement with projectors $\Pi_0$, $\Pi_1$', it is equivalent to just performing $M_2$ (the `$U$-rotated measurement') with projectors $\tilde{\Pi}_i = U^{\dagger} \Pi_i U$ as they give the same outputs on any state $\ket{\xi}$,
\begin{align*}
	\operatorname{prob}_{M_1}(i) = (\bra{\xi}U^{\dagger})\Pi_i (U \ket{\xi}) = \operatorname{prob}_{M_2}(i).
\end{align*}
Hence our process is equivalent to just a single measurement. 

Given $\ket{\alpha_0}$ or $\ket{\alpha_1}$, we can just perform a single measurement with projectors $\Pi_0$ and $\Pi_1$. Of course, some measurements are better than others for querying the correct answer with higher probability. We will introduce a `figure of merit' for the measurement, the \emph{success probability}.

\begin{definition}[Success Probability]
	With no prior knowledge of which state we are getting, we assume the prior probabilities of a half. Then the \vocab{success probability} $P_S$ is
	$$
	P_s = \frac{1}{2}\operatorname{prob}(\text{output is }0 \mid \ket{\alpha_0}\text{ input}) + \frac{1}{2}\operatorname{prob}(\text{output is }1 \mid \ket{\alpha_1}\text{ input}).
	$$
	so by the Born rule,
$$
P_s = \frac{1}{2}(\ev{\Pi_0}{\alpha_0} + \ev{\Pi_1}{\alpha_1}).
$$
\end{definition}

Since $\Pi_0 + \Pi_1 = I$, $\Pi_1 = I - \Pi_0$, so
\begin{align*}
	P_S &= \frac{1}{2} + \frac{1}{2}(\ev{\Pi_0}{\alpha_0} - \ev{\Pi_0}{\alpha_1}) \\
		&= \frac{1}{2} + \frac{1}{2}\tr\left[\Pi_0 (\op{\alpha_0}{\alpha_0} - \op{\alpha_1}{\alpha_1})\right],
\end{align*}
and we can calculate the optimal $\{\Pi_0, I - \Pi_0\}$. We look more closely at
$$
D = \dyad{\alpha_0} - \dyad{\alpha_1}.
$$
This has the following properties:
\begin{itemize}
	\item $D$ is hermitian, so it has real eigenvalues and has a complete basis of orthonormal eigenstates.
	\item If $\ket{\beta} \perp \ket{\alpha_0}$ and $\ket{\alpha_1}$, then $D \ket{beta} = 0$. So $D$ has only two non-zero eigenvalues, and the eigenvectors are spanned by $\ket{\alpha_0}$ and $\ket{\alpha_1}$.
	\item $\tr D = 0$, so the non-zero eigenvalues must sum to $0$. Thus we can write them as $+ \delta$ and $- \delta$, with $\delta>0$ and eigenstates $\ket{p}$ and $\ket{m}$.
	\item We can write
	$$
	D = \delta \dyad {p} - \delta\dyad{m}.
	$$
	Now we need to determine $\delta$ in terms of $\ket{\alpha_0}$ and $\ket{\alpha_1}$.
	\item We can work in the two dimensional subspace of $\ket{\alpha_0}$ and $\ket{\alpha_1}$. We will introduce an orthonormal basis so that we can work with components. We choose $\ket{\alpha_0^{\perp}}$ orthonormal to $\ket{\alpha_0}$, and we use $\{\ket{\alpha_0^{\perp}}, \ket{\alpha_0}\}$ as a basis. Then
	$$
	\ket{\alpha_0} = \begin{pmatrix}
		1 \\ 0
	\end{pmatrix}, \quad \ket{\alpha_1} = \begin{pmatrix}
		c_0 \\c_1
	\end{pmatrix} = c_0 \ket{\alpha_0} + c_1 \ket{\alpha_0^{\perp}}.
	$$
	So $c_0 = \ip{\alpha_0}{\alpha_1}$, and $|c_1| = \sin \theta$ for $\cos \theta = |\ip{\alpha_0}{\alpha_1}|$.
	\item We can then write down the projectors
	$$
	D = \begin{pmatrix}
		1 \\ 0
	\end{pmatrix}\begin{pmatrix}
		1 & 0
	\end{pmatrix} - \begin{pmatrix}
		c_0 \\ c_1
	\end{pmatrix}\begin{pmatrix}
		c_0^* & c_1^*
	\end{pmatrix}  = \begin{pmatrix}
		|c_1|^2 & -c_0c_1^* \\
		-c_1 c_0^* & -|c_1|^2
	\end{pmatrix},
	$$
	then $\det(D - \lambda I) = 0$ gives $\lambda = \pm |c_1| = \pm \sin \theta$. So $\delta = \sin \theta$.
\end{itemize}

Finally returning to our expression for the success probability,
we can use our new expression for $D$ to get
\begin{align*}
	P_s &= \frac{1}{2} + \frac{\delta}{2}\tr\left[\Pi_0 (\dyad{p} - \dyad{m})\right] \\
	&= \frac{1}{2} + \frac{\delta}{2}\left(\ev{\Pi_0}{p} - \ev{\Pi_0}{m}\right).
\end{align*}
Now for any projector $\Pi$ and state $\ket{\xi}$, we have $0 \leq \ev{\Pi}{\xi} \leq 1$. Hence $P_S$ achieves its maximum value of $\frac{1}{2} + \frac{\delta}{2} = \frac{1}{2}(1 + \sin \theta)$ if $\Pi_0$ is chosen to be any projector into a subspace containing $\ket{p}$ so $\Pi_0\ket{p} = \ket{p}$ and is orthogonal to $\ket{m}$, so that $\Pi_0 \ket{m} = \ket{0}$. Such a choice of $\Pi_0$ is always possible since $\ket{p}$ is orthogonal to $\ket{m}$. The achievable bound is then
$$
P_S \leq \frac{1}{2} + \frac{\sin \theta}{2},
$$
which is the \vocab{Helstrom-Holevo bound} (for pure states). 

In particular, an ancilla is never needed, only the inner product is relevant. Also, if $\ket{\alpha_0}$, $\ket{\alpha_1}$ are qubit states (with dimension 2), we can work entirely in their two dimensional space, and the optimal discriminating measurement will be a complete projective measurement of the quantum observable $D = \dyad{\alpha_0} - \dyad{\alpha_1}$, that is, measurement relative to the eigenbasis of $D$. 

We have thus proved the following theorem.

\begin{theorem}[Helstrom-Holevo Bound]
	Given one of two equally likely states, $\alpha_0$ and $\alpha_1$ with $|\ip{\alpha_0}{\alpha_1}| = \cos \theta$, the probability $P_S$ of correctly identifying the state by any quantum process is bounded by $P_S \leq \frac{1}{2}(1 + \sin \theta)$, and the bound is tight.
\end{theorem}

\begin{remark}
	There are other discrimination scenarios possible. One example is unambiguous state discrimination, where we have three outcome measurements which are \texttt{0}, \texttt{1} and \texttt{fail}. If \texttt{0} is seen, then the state received was certainly $\ket{\alpha_0}$. If \texttt{1} is seen, then it was certainly $\ket{\alpha_1}$, but if \texttt{fail} is seen, then the process has failed (and all information about the state is lost).
\end{remark}

\subsection{The No Signalling Principle}

Alice and Bob are distantly separated in space. They each have local quantum systems $A$ and $B$ respectively. Initially $AB$ is in some joint quantum state (which is possible entangled). They can apply only local operations (on their own system).

Suppose Alice does a complete measurement on her system. 
By the Born rule, for each outcome $k$ for $A$, the state at $B$ will `instantaneously' change (measurement collapse) to the corresponding post-measurement state $\ket{\beta_k}$.

Can Bob notice this change by just applying local actions?
If it was `yes', then we would get \emph{superluminal} or \emph{instantaneous} communication.
However, the answer is `no'.

We will first make the notion of `local operations' slightly clearer Consider a composite system $\ket{\psi}_{AB}$. Let $\mathcal{H}_A$ and $\mathcal{H}_B$ be state spaces of $A, B$, so that their joint state space is $\mathcal{H_A} \otimes \mathcal{H}_B$.

\begin{definition}[Local Unitary]
	A \emph{local unitary} $U$ by Alice or Bob respectively is represented on the full system by $U_A \otimes I_B$, or $I_A \otimes U_B$.
\end{definition}

\begin{remark}
	Local unitary operations on disjoint subsystems always commute.
	So $(U \otimes I)(I \otimes V) = (I \otimes V)(U \otimes I) = (U \otimes V)$.
\end{remark}

\begin{definition}[Local Ancilla]
	Each can adjoin \vocab{local ancilla} systems $A'$ and $B'$, which just enlarges their locally held system.
\end{definition}

\begin{definition}[Local Measure]
	If Alice performs a measurement on $A$ with orthogonal subspaces 
	$E_a$ and projectors $\Pi_a$ labelled by the outcomes $a$ (so that $\mathcal{H}_A = \bigoplus_{a} E_a$) then the full space is represented by $E_a \otimes \mathcal{H}_B$, and the projectors are $\Pi_A \otimes I_B$ on $\mathcal{H}_{AB}$.
\end{definition}

Thus even a complete measurement on $A$ (with one dimensional $E_a$'s) will be an incomplete measurement on $AB$ (with $\operatorname{dim} \mathcal{H}_B$ subspaces).

If Bob also did a local measurement (with subspaces $F_b$, projectors $\Pi_b$ and outcomes $b$), then by the Born rule, the joint probabilities $p(a, b)$ obtained by performing both measurements is independent of the order that measurements are performed.

Now we can state our result.

\begin{theorem}[No Signaling Theorem]
Suppose Alice and Bob have access only to subsystems $A$ and $B$ of a joint state $\ket{\phi}_{AB}$. Then Alice cannot convey any information to Bob by performing local operations.	
\end{theorem}
\begin{proof}
	Consider the case of $B$ performing a complete measurement with respect some basis $\{\ket{b}_B\}$, and with $A$ doing nothing.
	Using this basis in $\mathcal{H}_B$, we can write
	$$
	\ket{\phi}_{AB} = \sum_b \ket{\xi_b}A \ket{b}_B,
	$$
	where $\ket{\xi_b}_A = \,_B \ip{b}{\phi}_{AB}$.
	These are sub-normalised states with the sum of squared lengths being one, known as the `conditional state of $A$ given $b$',
	and by the Born rule, $\operatorname{prob}(b) = \ip{\xi_b}{\xi_b}$.

	Now suppose that Alice \emph{first} does a complete measurement with respect to the basis $\{\ket{a}\}$ of $\mathcal{H}_A$, with outcomes $a$ and projectors $\Pi_a = \dyad{a}$. Then 
	$$
	\operatorname{prob}(a) = \left|\sum_b (\Pi_a\ket{\xi_b}_A) \ket{b}_B\right|^2,
	$$
	and the post measurement state for outcome $a$ is
	\begin{equation}\label{eq:poststate}
		\ket{\psi_a}_{AB} = \frac{1}{\sqrt{\operatorname{prob}(a)}} \sum_b (\Pi_a \ket{\xi_b}_A) \ket{b}_B.\tag{$\dagger$}
	\end{equation}
	If \emph{now} $B$ does his measurement (and supposing Alice got outcome $a$), then
	$$
	\operatorname{prob}(b \mid a) = \frac{\left|\frac{\Pi_a}{\xi_b}\right|^2}{\operatorname{prob}(a)} = \frac{\ev{\Pi_a}{\xi_b}}{\operatorname{prob}(a)}
	$$
	Of course, Bob doesn't know what the outcome $a$ is, hence
	$$
	\operatorname{prob}(b) = \sum_a \operatorname{prob}(a) \cdot \operatorname{prob}(b \mid a)  = \sum_a \ev{\Pi_a}{\xi_b} = \ip{\xi_b}{\xi_b},
	$$
	since $\sum_a \Pi_a = I_A$, which is the same as before (when Alice did nothing first).
\end{proof}

\begin{remark}[Other Local Actions]
	Clearly this generalizes to incomplete $A$ measurements (since $\sum \Pi = I$). Also if Alice performs a local unitary $U_a$ first, then we have something like $\ket{\xi_b}_A \mapsto \ket{\xi_b'} = U_A\ket{\xi_b}_A$, and $\ip{\xi_b'}{\xi_b'} = \ip{\xi_b}{\xi_b}$. So again, $B$'s probabilities are not changed.
	Also if $A$ and $B$ include local ancillas, this just enlarges the local spaces and the shared state, and the above arguments still apply.
\end{remark}


\end{document}
